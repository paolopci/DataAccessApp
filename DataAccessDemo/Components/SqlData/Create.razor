@* Definisce l'URL di routing per questa pagina *@
@page "/create"
@* Abilita l'interattività lato server *@
@rendermode InteractiveServer
@* Inietta il servizio per le operazioni sul database *@
@inject IPeopleData sql

<h3>Create Person</h3>

@* EditForm gestisce la sottomissione del form e la validazione *@
<EditForm Model="person" OnValidSubmit="CreatePerson" FormName="createPersonForm" class="p-3">
    @* Abilita la validazione basata sulle Data Annotations nel modello *@
    <DataAnnotationsValidator />
    @* Mostra un riepilogo degli errori di validazione *@
    <ValidationSummary />
    <div class="mb-3">
        <label class="form-label" for="FirstName">First Name</label>
        @* InputText lega il valore al campo FirstName del modello *@
        <InputText id="FirstName" class="form-control" @bind-Value="person.FirstName" />
        <ValidationMessage For="() => person.FirstName" />
    </div>
    <div class="mb-3">
        <label class="form-label" for="LastName">Last Name</label>
        <InputText id="LastName" class="form-control" @bind-Value="person.LastName" />
        <ValidationMessage For="() => person.LastName" />
    </div>
    <button type="submit" class="btn btn-primary mt-2">Create Person</button>
</EditForm>


@code {
    // Istanza del modello per memorizzare i dati del form
    private PersonModel person = new();

    // Metodo chiamato quando il form viene sottomesso ed è valido
    private async Task CreatePerson()
    {
        // Chiama il servizio per inserire la nuova persona
        await sql.InsertPerson(person);
        // Resetta il form creando una nuova istanza vuota
        person = new();
    }
}
